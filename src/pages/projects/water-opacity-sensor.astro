---
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { siteConfig } from "../../config";
import "../../styles/global.css";

// PROJECT META
const projectName = "Water Opacity Sensor (WOS)";
const projectTagline =
  "PIC-based optical sensor PCB for water clarity classification via light intensity.";
const projectSummary =
  "Designed and fabricated a PIC-based optical sensor PCB that measures water opacity via light intensity, classifies safe and unsafe ranges, and supports remote start/stop and digital interfacing.";

// IMAGE PATHS (you already uploaded these)
const imgBase = "/images/projects/WOS";
const heroImg = `${imgBase}/WOS_PCBB.jpg`;        // hero
const bdImg = `${imgBase}/WOS_BD.png`;            // block diagram
const schematicImg = `${imgBase}/WOS_Schematic.png`;
const pcbFrontImg = `${imgBase}/WOS_PCBF.jpg`;
const pcbBackImg = `${imgBase}/WOS_PCBB.jpg`;     // reuse is fine
const completeImg = `${imgBase}/WOS_Complete.jpg`;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>{projectName} | {siteConfig.name}</title>
    <meta name="description" content={projectSummary} />
  </head>

  <body class="bg-background text-foreground">
    <Header />

    <main class="pt-24 pb-16">
      <section class="max-w-4xl mx-auto px-6 space-y-10">
        {/* Top header */}
        <header class="space-y-3">
          <p class="text-sm uppercase tracking-[0.25em]" style={`color:${siteConfig.accentColor}`}>
            Project
          </p>

          <h1 class="text-4xl sm:text-5xl font-bold text-gray-100">
            {projectName}
          </h1>

          <p class="text-base sm:text-lg text-gray-400">
            {projectTagline}
          </p>

          <p class="text-sm sm:text-base text-gray-400">
            {projectSummary}
          </p>
        </header>

        {/* Hero */}
        <section class="space-y-4">
          <div class="overflow-hidden rounded-2xl border border-slate-800 bg-slate-900/60">
            <div class="relative aspect-[16/9] w-full">
              <img
                src={heroImg}
                alt="Water Opacity Sensor PCB hero"
                class="absolute inset-0 h-full w-full object-cover"
                loading="eager"
              />
              <div class="absolute inset-0 bg-black/25" />
            </div>
          </div>
        </section>

        {/* Why */}
        <section class="space-y-4">
          <h2 class="text-2xl font-semibold text-gray-100">Why</h2>
          <p class="text-gray-300 leading-relaxed">
            This subsystem was built to classify water clarity using a low-cost optical method.
            The goal was to convert light intensity through a sample into a stable electrical signal,
            then output an unambiguous safe/unsafe state that could be shared with the broader team system.
          </p>
          <h3 class="text-lg font-semibold text-gray-100">Constraints</h3>
          <ul class="list-disc list-inside space-y-2 text-gray-300">
            <li>Readable, stable output despite sensor variance and ambient light noise.</li>
            <li>Simple safe/unsafe classification with adjustable thresholding.</li>
            <li>Integration with a team-controlled master system via digital I/O.</li>
            <li>Designed, built, and validated within a class project timeline.</li>
          </ul>
        </section>

        {/* What */}
        <section class="space-y-4">
          <h2 class="text-2xl font-semibold text-gray-100">What</h2>
          <p class="text-gray-300 leading-relaxed">
            The system uses a photoresistor to sense light attenuation, conditions that signal with an op-amp stage,
            then uses a PIC microcontroller ADC to classify opacity and drive digital outputs (status LEDs and I/O lines).
          </p>

          <h3 class="text-lg font-semibold text-gray-100">Key capabilities</h3>
          <ul class="list-disc list-inside space-y-2 text-gray-300">
            <li>Measures opacity via light intensity and converts it into an ADC-readable signal.</li>
            <li>Outputs safe/unsafe states based on a programmable threshold range.</li>
            <li>Supports remote start/stop and digital interfacing with the programming lead’s subsystem.</li>
          </ul>
        </section>

        {/* Block diagram */}
        <section class="space-y-4">
          <h2 class="text-2xl font-semibold text-gray-100">Block Diagram</h2>
          <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4">
            <img
              src={bdImg}
              alt="WOS block diagram"
              class="w-full h-auto rounded-xl border border-slate-800 bg-slate-950/40"
              loading="lazy"
            />
            <p class="mt-3 text-sm text-gray-400">
              Signal flow from sensor to conditioned analog output to PIC ADC and digital state outputs.
            </p>
          </div>
        </section>

        {/* Schematic */}
        <section class="space-y-4">
          <h2 class="text-2xl font-semibold text-gray-100">Schematic</h2>
          <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4">
            <img
              src={schematicImg}
              alt="WOS schematic"
              class="w-full h-auto rounded-xl border border-slate-800 bg-slate-950/40"
              loading="lazy"
            />
            <p class="mt-3 text-sm text-gray-400">
              Includes photoresistor amplifier path, LED indicators, and PIC Curiosity Nano pin mapping.
            </p>
          </div>
        </section>

        {/* PCB */}
        <section class="space-y-4">
          <h2 class="text-2xl font-semibold text-gray-100">PCB Layout</h2>

          <div class="grid gap-4 sm:grid-cols-2">
            <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4">
              <p class="text-sm text-gray-400 mb-3">Front</p>
              <img
                src={pcbFrontImg}
                alt="WOS PCB front"
                class="w-full h-auto rounded-xl border border-slate-800 bg-slate-950/40"
                loading="lazy"
              />
            </div>

            <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4">
              <p class="text-sm text-gray-400 mb-3">Back</p>
              <img
                src={pcbBackImg}
                alt="WOS PCB back"
                class="w-full h-auto rounded-xl border border-slate-800 bg-slate-950/40"
                loading="lazy"
              />
            </div>
          </div>
        </section>

        {/* How */}
        <section class="space-y-4">
          <h2 class="text-2xl font-semibold text-gray-100">How</h2>
          <p class="text-gray-300 leading-relaxed">
            I owned the full sensor subsystem from schematic through validation.
            I designed the analog signal conditioning and PCB in KiCad, assembled and debugged the board,
            and implemented the ADC high/low interpretation to generate stable digital states.
            I coordinated the digital interfacing details with the programming lead to ensure clean board-to-board communication.
          </p>

          <h3 class="text-lg font-semibold text-gray-100">Build process</h3>
          <ol class="list-decimal list-inside space-y-2 text-gray-300">
            <li>Defined sensing approach, selected photoresistor and op-amp signal conditioning strategy.</li>
            <li>Captured schematic and PCB layout in KiCad with test points and integration headers.</li>
            <li>Assembled board, verified power and analog signal path, then validated ADC behavior.</li>
            <li>Mapped safe/unsafe thresholds to digital outputs and confirmed I/O compatibility with the team system.</li>
          </ol>
        </section>

        {/* Testing & Results */}
        <section class="space-y-4">
          <h2 class="text-2xl font-semibold text-gray-100">Testing &amp; Results</h2>
          <p class="text-gray-300 leading-relaxed">
            The sensor successfully classified opacity based on light intensity and produced a stable safe/unsafe output.
            Threshold behavior was configurable in software, and the subsystem supported remote start/stop plus digital state reporting.
          </p>

          <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-4">
            <img
              src={completeImg}
              alt="WOS assembled and connected"
              class="w-full h-auto rounded-xl border border-slate-800 bg-slate-950/40"
              loading="lazy"
            />
            <p class="mt-3 text-sm text-gray-400">
              Assembled system and integration setup.
            </p>
          </div>

          <ul class="list-disc list-inside space-y-2 text-gray-300">
            <li>Validated analog conditioning and ADC read stability across varying light conditions.</li>
            <li>Confirmed safe/unsafe state transitions at the programmed threshold range.</li>
            <li>Verified digital I/O outputs for downstream integration and status indication.</li>
          </ul>
        </section>

        {/* What I'd do next */}
        <section class="space-y-4">
          <h2 class="text-2xl font-semibold text-gray-100">What I&apos;d Do Next</h2>
          <ul class="list-disc list-inside space-y-2 text-gray-300">
            <li>Add mechanical light shielding to reduce ambient sensitivity and improve repeatability.</li>
            <li>Calibrate against known turbidity standards to map readings to real units.</li>
            <li>Replace photoresistor with a photodiode for faster response and improved linearity.</li>
          </ul>
        </section>

        {/* Back link */}
        <div class="pt-4">
          <a
            href="/projects"
            class="text-sm underline-offset-2 hover:underline"
            style={`color:${siteConfig.accentColor}`}
          >
            ← Back to all projects
          </a>
        </div>
      </section>
    </main>

    <Footer />
  </body>
</html>
